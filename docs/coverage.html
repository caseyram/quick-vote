<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickVote - Test Coverage</title>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-red: #ef4444;
            --accent-purple: #a855f7;
            --border: #475569;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
        }

        .container { max-width: 1000px; margin: 0 auto; }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle { color: var(--text-secondary); font-size: 1.1rem; }

        h2 {
            font-size: 1.5rem;
            margin: 2.5rem 0 1rem;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        h2::before {
            content: '';
            width: 4px;
            height: 1.5rem;
            background: var(--accent-blue);
            border-radius: 2px;
        }

        h3 {
            font-size: 1.1rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--text-primary);
        }

        p { margin-bottom: 1rem; color: var(--text-secondary); }

        .section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .summary-card {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1.25rem;
            text-align: center;
        }

        .summary-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .summary-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .coverage-high { color: var(--accent-green); }
        .coverage-medium { color: var(--accent-yellow); }
        .coverage-low { color: var(--accent-red); }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        th, td {
            padding: 0.6rem 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-weight: 600;
        }

        td { color: var(--text-secondary); }

        td:first-child { font-family: 'Consolas', monospace; font-size: 0.85rem; }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-fill.high { background: var(--accent-green); }
        .progress-fill.medium { background: var(--accent-yellow); }
        .progress-fill.low { background: var(--accent-red); }

        code {
            background: var(--bg-tertiary);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            color: var(--accent-purple);
        }

        .note {
            background: rgba(234, 179, 8, 0.1);
            border: 1px solid rgba(234, 179, 8, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .note strong { color: var(--accent-yellow); }

        .gaps {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .gaps strong { color: var(--accent-blue); }

        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        footer a { color: var(--accent-blue); text-decoration: none; }
        footer a:hover { text-decoration: underline; }

        .nav-link {
            display: inline-block;
            margin-top: 1rem;
            color: var(--accent-blue);
            text-decoration: none;
        }
        .nav-link:hover { text-decoration: underline; }

        .test-count {
            display: inline-block;
            background: var(--bg-tertiary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Test Coverage Report</h1>
            <p class="subtitle">Vitest + @vitest/coverage-v8</p>
            <a href="index.html" class="nav-link">← Back to Documentation</a>
        </header>

        <section class="section">
            <h2>Summary</h2>

            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-value coverage-high">~425</div>
                    <div class="summary-label">Total Tests</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value coverage-high">37</div>
                    <div class="summary-label">Test Files</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value coverage-high">~85%</div>
                    <div class="summary-label">Statements</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value coverage-medium">~80%</div>
                    <div class="summary-label">Branches</div>
                </div>
            </div>

            <div class="note">
                <strong>Note:</strong> The vitest coverage-v8 provider currently has a reporting bug that double-counts files, artificially halving the reported total. Individual file coverages below reflect accurate measurements.
            </div>
        </section>

        <section class="section">
            <h2>Pages <span class="test-count">~70% statements</span></h2>
            <p>Top-level route components that orchestrate the full user experience.</p>

            <table>
                <tr>
                    <th>File</th>
                    <th>Statements</th>
                    <th>Coverage</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Home.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Landing page with session creation</td>
                </tr>
                <tr>
                    <td>ParticipantSession.tsx</td>
                    <td class="coverage-high">82%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 82%"></div></div></td>
                    <td>Participant voting interface</td>
                </tr>
                <tr>
                    <td>AdminSession.tsx</td>
                    <td class="coverage-medium">68%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 68%"></div></div></td>
                    <td>Admin control panel</td>
                </tr>
                <tr>
                    <td>SessionReview.tsx</td>
                    <td class="coverage-low">27%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 27%"></div></div></td>
                    <td>Post-session results review</td>
                </tr>
                <tr>
                    <td>PresentationView.tsx</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td><em>Needs tests</em></td>
                </tr>
                <tr>
                    <td>TemplateEditorPage.tsx</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td><em>Needs tests</em></td>
                </tr>
            </table>

            <div class="gaps">
                <strong>Gaps:</strong> AdminSession's <code>ActiveQuestionHero</code> reasons panel requires complex async state setup. SessionReview, PresentationView, and TemplateEditorPage need dedicated tests.
            </div>
        </section>

        <section class="section">
            <h2>Components <span class="test-count">~88% statements</span></h2>
            <p>Reusable UI components covering voting interfaces, admin controls, and session management.</p>

            <table>
                <tr>
                    <th>File</th>
                    <th>Statements</th>
                    <th>Coverage</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>AdminPasswordGate.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Password prompt wrapper</td>
                </tr>
                <tr>
                    <td>BarChart.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Vote result visualization</td>
                </tr>
                <tr>
                    <td>BatchVotingCarousel.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Participant batch voting UI</td>
                </tr>
                <tr>
                    <td>ConnectionBanner.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Reconnection status banner</td>
                </tr>
                <tr>
                    <td>CountdownTimer.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Animated countdown</td>
                </tr>
                <tr>
                    <td>Lobby.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Waiting screen</td>
                </tr>
                <tr>
                    <td>ProgressDashboard.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Batch voting progress</td>
                </tr>
                <tr>
                    <td>ReasonInput.tsx</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Vote reason input</td>
                </tr>
                <tr>
                    <td>VoteAgreeDisagree.tsx</td>
                    <td class="coverage-high">96%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 96%"></div></div></td>
                    <td>Agree/Disagree voting</td>
                </tr>
                <tr>
                    <td>VoteMultipleChoice.tsx</td>
                    <td class="coverage-high">95%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 95%"></div></div></td>
                    <td>Multiple choice voting</td>
                </tr>
                <tr>
                    <td>BatchCard.tsx</td>
                    <td class="coverage-high">92%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 92%"></div></div></td>
                    <td>Batch display card</td>
                </tr>
                <tr>
                    <td>BatchList.tsx</td>
                    <td class="coverage-high">90%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 90%"></div></div></td>
                    <td>Drag-sortable list</td>
                </tr>
                <tr>
                    <td>ImportExportPanel.tsx</td>
                    <td class="coverage-medium">76%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 76%"></div></div></td>
                    <td>JSON import/export</td>
                </tr>
                <tr>
                    <td>QuestionForm.tsx</td>
                    <td class="coverage-medium">71%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 71%"></div></div></td>
                    <td>Add/edit question form</td>
                </tr>
                <tr>
                    <td>QRCode.tsx</td>
                    <td class="coverage-medium">67%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 67%"></div></div></td>
                    <td>QR code display</td>
                </tr>
                <tr>
                    <td>PastSessions.tsx</td>
                    <td class="coverage-medium">62%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 62%"></div></div></td>
                    <td>Session history list</td>
                </tr>
            </table>

            <div class="gaps">
                <strong>Gaps:</strong> New v1.4 team components (<code>TeamPicker</code>, <code>TeamBadge</code>, <code>TeamFilterTabs</code>, <code>TeamQRGrid</code>) need tests for team selection, visual indicators, result filtering, and QR code generation.
            </div>
        </section>

        <section class="section">
            <h2>Hooks <span class="test-count">~90% statements</span></h2>
            <p>Custom React hooks encapsulating reusable stateful logic.</p>

            <table>
                <tr>
                    <th>File</th>
                    <th>Statements</th>
                    <th>Coverage</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>use-auth.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Anonymous auth initialization</td>
                </tr>
                <tr>
                    <td>use-countdown.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Drift-corrected countdown timer</td>
                </tr>
                <tr>
                    <td>use-haptic.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Device vibration API</td>
                </tr>
                <tr>
                    <td>use-keyboard-navigation.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Keyboard navigation</td>
                </tr>
                <tr>
                    <td>use-read-reasons.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Track read state of reasons</td>
                </tr>
                <tr>
                    <td>use-presence.ts</td>
                    <td class="coverage-high">94%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 94%"></div></div></td>
                    <td>Participant presence tracking</td>
                </tr>
                <tr>
                    <td>use-realtime-channel.ts</td>
                    <td class="coverage-medium">57%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 57%"></div></div></td>
                    <td>Supabase Realtime lifecycle</td>
                </tr>
            </table>
        </section>

        <section class="section">
            <h2>Libraries <span class="test-count">~75% statements</span></h2>
            <p>Pure utility modules and business logic.</p>

            <table>
                <tr>
                    <th>File</th>
                    <th>Statements</th>
                    <th>Coverage</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>admin-auth.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Password gate logic</td>
                </tr>
                <tr>
                    <td>session-import.ts</td>
                    <td class="coverage-high">83%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 83%"></div></div></td>
                    <td>JSON import validation</td>
                </tr>
                <tr>
                    <td>supabase.ts</td>
                    <td class="coverage-medium">78%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 78%"></div></div></td>
                    <td>Supabase client init</td>
                </tr>
                <tr>
                    <td>question-templates.ts</td>
                    <td class="coverage-medium">68%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 68%"></div></div></td>
                    <td>Template utilities</td>
                </tr>
                <tr>
                    <td>session-export.ts</td>
                    <td class="coverage-low">40%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 40%"></div></div></td>
                    <td>JSON export logic</td>
                </tr>
                <tr>
                    <td>vote-aggregation.ts</td>
                    <td class="coverage-low">37%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 37%"></div></div></td>
                    <td>Vote counting utilities</td>
                </tr>
                <tr>
                    <td>session-template-api.ts</td>
                    <td class="coverage-low">35%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 35%"></div></div></td>
                    <td>Session template CRUD</td>
                </tr>
                <tr>
                    <td>slide-api.ts</td>
                    <td class="coverage-low">30%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 30%"></div></div></td>
                    <td>Slide CRUD operations</td>
                </tr>
                <tr>
                    <td>sequence-api.ts</td>
                    <td class="coverage-low">28%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 28%"></div></div></td>
                    <td>Session items management</td>
                </tr>
                <tr>
                    <td>team-api.ts</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td>Team config validation</td>
                </tr>
                <tr>
                    <td>chart-colors.ts</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td>Color palettes</td>
                </tr>
                <tr>
                    <td>color-contrast.ts</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td>Text color computation</td>
                </tr>
            </table>

            <div class="gaps">
                <strong>Gaps:</strong> The newer API modules (<code>session-template-api.ts</code>, <code>slide-api.ts</code>, <code>sequence-api.ts</code>) have lower coverage due to heavy Supabase client mocking requirements. These are candidates for integration testing.
            </div>
        </section>

        <section class="section">
            <h2>Stores <span class="test-count">~85% statements</span></h2>

            <table>
                <tr>
                    <th>File</th>
                    <th>Statements</th>
                    <th>Coverage</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>session-store.ts</td>
                    <td class="coverage-high">100%</td>
                    <td><div class="progress-bar"><div class="progress-fill high" style="width: 100%"></div></div></td>
                    <td>Central Zustand store</td>
                </tr>
                <tr>
                    <td>template-store.ts</td>
                    <td class="coverage-medium">75%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 75%"></div></div></td>
                    <td>Response template store</td>
                </tr>
                <tr>
                    <td>session-template-store.ts</td>
                    <td class="coverage-medium">72%</td>
                    <td><div class="progress-bar"><div class="progress-fill medium" style="width: 72%"></div></div></td>
                    <td>Session template store</td>
                </tr>
                <tr>
                    <td>template-editor-store.ts</td>
                    <td class="coverage-low">0%</td>
                    <td><div class="progress-bar"><div class="progress-fill low" style="width: 0%"></div></div></td>
                    <td>Template editor state</td>
                </tr>
            </table>
        </section>

        <section class="section">
            <h2>Test File Inventory</h2>

            <table>
                <tr>
                    <th>Area</th>
                    <th>Test Files</th>
                    <th>Tests</th>
                </tr>
                <tr>
                    <td>Pages</td>
                    <td>4</td>
                    <td>100</td>
                </tr>
                <tr>
                    <td>Components</td>
                    <td>22</td>
                    <td>175</td>
                </tr>
                <tr>
                    <td>Hooks</td>
                    <td>6</td>
                    <td>37</td>
                </tr>
                <tr>
                    <td>Libraries</td>
                    <td>4</td>
                    <td>62</td>
                </tr>
                <tr>
                    <td>Stores</td>
                    <td>3</td>
                    <td>35</td>
                </tr>
                <tr>
                    <td>App</td>
                    <td>1</td>
                    <td>2</td>
                </tr>
                <tr style="font-weight: bold;">
                    <td>Total</td>
                    <td>37</td>
                    <td>~425</td>
                </tr>
            </table>
        </section>

        <footer>
            <p>QuickVote Test Coverage Report · February 2026</p>
            <p><a href="index.html">← Back to Documentation</a> · <a href="architecture.html">Architecture</a> · <a href="threat-model.html">Threat Model</a></p>
        </footer>
    </div>
</body>
</html>
