---
phase: 21-export-import-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/SequenceItemCard.tsx
  - src/components/QROverlay.tsx
autonomous: true

must_haves:
  truths:
    - "Slide items in the sequence editor display a w-16 h-12 (64x48px) thumbnail image with caption text beside it"
    - "Thumbnail images lazy-load and display with correct aspect ratio (object-cover)"
    - "Batch items in the sequence editor display a small icon for visual consistency with slide thumbnails"
    - "QR overlay on content slides has a semi-transparent white background for scannability"
    - "QR overlay works identically on both batch and slide content in the presentation view"
  artifacts:
    - path: "src/components/SequenceItemCard.tsx"
      provides: "Enlarged slide thumbnails (w-16 h-12) and batch item icons in sequence editor"
      contains: "w-16 h-12|object-cover|loading.*lazy"
    - path: "src/components/QROverlay.tsx"
      provides: "Semi-transparent QR overlay background for slide scannability"
      contains: "bg-white/90"
  key_links:
    - from: "src/components/SequenceItemCard.tsx"
      to: "src/lib/slide-api.ts"
      via: "getSlideImageUrl for thumbnail src"
      pattern: "getSlideImageUrl"
    - from: "src/components/QROverlay.tsx"
      to: "src/pages/PresentationView.tsx"
      via: "QROverlay rendered in presentation view for both batches and slides"
      pattern: "QROverlay"
---

<objective>
Add slide preview thumbnails to the sequence editor for at-a-glance identification and update the QR overlay with a semi-transparent background for scannability on content slides.

Purpose: Visual polish for the sequence editor (thumbnails help identify slides without clicking) and ensure QR codes are readable against any slide image background.
Output: Updated SequenceItemCard with larger thumbnails and QROverlay with semi-transparent card.
</objective>

<execution_context>
@C:\Users\cramo\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cramo\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-export-import-polish/21-CONTEXT.md
@.planning/phases/21-export-import-polish/21-RESEARCH.md

# Key source files
@src/components/SequenceItemCard.tsx
@src/components/SequenceManager.tsx
@src/components/QROverlay.tsx
@src/pages/PresentationView.tsx
@src/lib/slide-api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade slide thumbnails and batch item visual treatment in SequenceItemCard</name>
  <files>src/components/SequenceItemCard.tsx</files>
  <action>
Upgrade the slide item display in SequenceItemCard.tsx to use larger thumbnails and improve batch item visual treatment for consistency.

**Current state:** Slide items already have an 8x8 (w-8 h-8) thumbnail with `object-cover`. Batch items show name and question count but no thumbnail-sized visual element.

**Changes to SequenceItemCard.tsx:**

1. **Enlarge slide thumbnail to w-16 h-12 (64x48px)** (CONTEXT.md specifies "medium preview size 60-80px"):
- Change the slide image container from `w-8 h-8` to `w-16 h-12` (~64x48px, maintains ~4:3 aspect ratio good for slide previews)
- Keep `object-cover` and `rounded` classes
- Keep `loading="lazy"` attribute
- Keep the existing error fallback (data:image/svg+xml placeholder)

2. **Update slide content layout** for thumbnail + text side-by-side (CONTEXT: "thumbnail on the left, slide title/label text to the right"):
```tsx
{isSlide ? (
  <div className="flex items-center gap-3">
    {item.slide_image_path && (
      <div className="w-16 h-12 bg-gray-100 rounded overflow-hidden flex-shrink-0">
        <img
          src={getSlideImageUrl(item.slide_image_path)}
          alt={item.slide_caption || 'Slide'}
          className="w-full h-full object-cover"
          loading="lazy"
          onError={(e) => {
            const target = e.target as HTMLImageElement;
            target.src = 'data:image/svg+xml,...'; // existing fallback
          }}
        />
      </div>
    )}
    <div className="flex-1 min-w-0">
      <div className="text-sm font-medium text-gray-900 truncate">
        {item.slide_caption || <span className="text-gray-400 italic">Untitled Slide</span>}
      </div>
      <div className="text-xs text-gray-500">Slide</div>
    </div>
  </div>
) : null}
```

3. **Add visual consistency to batch items** (Claude's discretion per CONTEXT.md):
- The batch content area already shows the batch name and question count
- Add a subtle batch visual indicator for symmetry with the slide thumbnail area
- This could be: keep the existing layout but ensure the batch name area has similar vertical height to slide thumbnail cards so the list isn't jagged
- The type icon (list icon for batch, image icon for slide) already provides differentiation
- No major change needed here -- the existing batch display is already clear. Just ensure the card heights are visually consistent by matching padding.

4. **Adjust overall card padding** if needed to accommodate the larger thumbnail without making the card feel cramped. The current `p-3` should be fine with a 48-56px tall thumbnail.

NOTE: This is admin-only UI, use LIGHT theme (bg-white, text-gray-900). The slide thumbnail background should use `bg-gray-100` (light gray, not dark) since this is the admin light theme.
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compilation. Visually verify that slide items show larger thumbnails and batch items remain visually balanced. Run `npx vitest run` to confirm no test regressions.
  </verify>
  <done>
Slide items in the sequence editor display w-16 h-12 (64x48px) thumbnails with caption text beside them. Batch items remain visually balanced. All items have consistent card heights. Thumbnails lazy-load with object-cover.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add semi-transparent background to QR overlay for slide scannability</name>
  <files>src/components/QROverlay.tsx</files>
  <action>
Update the QR overlay corner mode to use a semi-transparent white background so QR codes remain scannable against any slide image background.

**Current state (QROverlay.tsx line 17):**
```tsx
<div className="fixed bottom-4 right-4 z-50 bg-white rounded-xl shadow-lg p-3">
```

**Change:** Replace `bg-white` with `bg-white/90` for 90% opacity semi-transparent card:
```tsx
<div className="fixed bottom-4 right-4 z-50 bg-white/90 rounded-xl shadow-lg p-3">
```

This is a one-line change. The 90% opacity ensures:
- QR code is still easily scannable (white background behind black QR squares)
- Slight transparency makes the overlay feel less heavy on top of slide images
- Consistent look whether displayed over slides or batch results

NOTE: Only change the `corner` mode. The `fullscreen` mode should keep its solid `bg-white` background since it occupies the entire screen and transparency would look odd.

No other changes needed -- the QR overlay already renders in PresentationView.tsx (line 370) and works for both batch and slide content types. The toggle is controlled by the admin via broadcast (Phase 19).
  </action>
  <verify>
Run `npx tsc --noEmit` to verify no compilation errors. Run `npx vitest run` to check for regressions. Visually verify the QR overlay appears with slight transparency over a slide in presentation mode.
  </verify>
  <done>
QR overlay corner mode uses bg-white/90 semi-transparent background. Overlay is scannable against any slide image. Fullscreen mode retains solid white background.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- no TypeScript errors
2. `npx vitest run` -- full test suite passes
3. Visual: sequence editor shows w-16 h-12 (64x48px) slide thumbnails with captions
4. Visual: QR overlay on slides has semi-transparent white background
5. Visual: batch items and slide items in sequence editor have consistent visual weight
</verification>

<success_criteria>
- Slide thumbnails in sequence editor are w-16 h-12 (64x48px) with object-cover and lazy loading
- Batch items remain visually balanced alongside slide thumbnails
- QR overlay corner mode uses semi-transparent white (bg-white/90) background
- All existing tests pass without modification
</success_criteria>

<output>
After completion, create `.planning/phases/21-export-import-polish/21-02-SUMMARY.md`
</output>
