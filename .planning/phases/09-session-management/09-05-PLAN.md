---
phase: 09-session-management
plan: 05
type: execute
wave: 2
depends_on: ["09-04"]
files_modified:
  - src/pages/AdminSession.tsx
autonomous: false

must_haves:
  truths:
    - "Import panel is accessible from admin session view"
    - "Import refreshes question/batch list after completion"
  artifacts:
    - path: "src/pages/AdminSession.tsx"
      provides: "Import panel integration"
      contains: "ImportSessionPanel"
  key_links:
    - from: "src/pages/AdminSession.tsx"
      to: "src/components/ImportSessionPanel.tsx"
      via: "component render"
      pattern: "<ImportSessionPanel"
---

<objective>
Wire ImportSessionPanel into AdminSession view so admins can import questions/batches into their current session.

Purpose: Completes SESS-05 by placing import UI in accessible location.
Output: ImportSessionPanel integrated into AdminSession.tsx
</objective>

<execution_context>
@C:\Users\cramo\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\cramo\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-session-management/09-CONTEXT.md
@.planning/phases/09-session-management/09-04-SUMMARY.md

@src/pages/AdminSession.tsx
@src/components/ImportExportPanel.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate ImportSessionPanel into AdminSession</name>
  <files>src/pages/AdminSession.tsx</files>
  <action>
Add ImportSessionPanel to AdminSession.tsx:

1. **Import the component:**
```typescript
import { ImportSessionPanel } from '../components/ImportSessionPanel';
```

2. **Find the existing ImportExportPanel location** - the import panel should be placed nearby for consistent UX.

3. **Add ImportSessionPanel with refresh handler:**
```typescript
<ImportSessionPanel
  sessionId={session.session_id}
  onImportComplete={async (result) => {
    // Refetch questions and batches after import
    const { data: questions } = await supabase
      .from('questions')
      .select('*')
      .eq('session_id', session.session_id)
      .order('position');

    const { data: batches } = await supabase
      .from('batches')
      .select('*')
      .eq('session_id', session.session_id)
      .order('position');

    if (questions) useSessionStore.getState().setQuestions(questions);
    if (batches) useSessionStore.getState().setBatches(batches);
  }}
/>
```

4. **Placement:** Add alongside or below the existing ImportExportPanel. The existing panel handles simple question JSON (from lib/question-templates.ts), while ImportSessionPanel handles full session JSON with batches.

5. **Consider adding a label/divider:**
```typescript
<div className="space-y-4">
  <div>
    <p className="text-sm text-gray-500 mb-2">Quick import (questions only)</p>
    <ImportExportPanel sessionId={session.session_id} />
  </div>
  <div>
    <p className="text-sm text-gray-500 mb-2">Full import (with batches)</p>
    <ImportSessionPanel sessionId={session.session_id} onImportComplete={...} />
  </div>
</div>
```

Or if UI feels cluttered, replace ImportExportPanel with ImportSessionPanel entirely (the new format is a superset).

Review AdminSession.tsx structure to determine best placement - likely in the same area as existing import/export controls.
  </action>
  <verify>Run `npm run build`. Import panel visible in admin session view.</verify>
  <done>ImportSessionPanel renders in AdminSession and refreshes data after import</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 9 Session Management features</what-built>
  <how-to-verify>
1. Navigate to /admin - verify session list appears with search, delete, new session, review, export buttons
2. Create a new session from /admin - verify navigation to admin view
3. Delete a session - verify confirmation dialog and removal from list
4. Search sessions - verify filtering works with debounce
5. Click Export on a session - verify JSON file downloads with correct structure (batches, questions, votes)
6. Click Review on a session - verify batch-grouped results display
7. In session admin view, import a JSON file:
   - Test with invalid JSON (should show error)
   - Test with valid JSON (should show preview, then import)
   - Verify imported batches and questions appear in session
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` compiles without errors
2. AdminSession.tsx includes ImportSessionPanel
3. Import completes and refreshes question/batch lists
4. Full end-to-end flow works: list -> review -> export -> import cycle
</verification>

<success_criteria>
- Import panel accessible in admin session view
- Import refreshes data after completion
- All SESS requirements verified end-to-end
</success_criteria>

<output>
After completion, create `.planning/phases/09-session-management/09-05-SUMMARY.md`
</output>
