---
phase: 24-presentation-polish
plan: 05
type: execute
wave: 4
depends_on: ["24-04"]
files_modified:
  - src/components/PresentationControls.tsx
autonomous: false
gap_closure: true
must_haves:
  truths:
    - "Navigation Previous/Next buttons are fully visible and clickable when a batch item is active"
    - "Navigation Previous/Next buttons are fully visible and clickable when a slide item is active"
    - "BatchControlPanel content scrolls within its own bounded area without overlapping nav buttons"
  artifacts:
    - path: "src/components/PresentationControls.tsx"
      provides: "Restructured center area layout with guaranteed nav button visibility"
      contains: "Navigation controls"
  key_links:
    - from: "Center area flex container"
      to: "Navigation controls bar"
      via: "flex-col layout with overflow-hidden on content area and shrink-0 on nav bar"
      pattern: "shrink-0.*border-t"
---

<objective>
Fix PRES-06: Navigation buttons obscured by BatchControlPanel when a batch is active.

Purpose: The only remaining gap blocking Phase 24 completion. Human verification confirmed that while `shrink-0` prevents nav buttons from being pushed off-screen, the BatchControlPanel visually obscures them. The fix restructures the center area so the batch view follows the same constrained pattern as the slide view — content fills the space above a fixed, always-visible navigation bar.

Output: Updated PresentationControls.tsx with guaranteed nav button visibility in both slide and batch views.
</objective>

<execution_context>
@C:/Users/cramo/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/cramo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/PresentationControls.tsx
@.planning/phases/24-presentation-polish/24-VERIFICATION.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure center area layout to guarantee nav button visibility</name>
  <files>src/components/PresentationControls.tsx</files>
  <action>
The root cause is that the center area (lines 207-270) uses a flex-col where the BatchControlPanel's wrapper div has `flex-1 min-h-0 mb-4 overflow-hidden`, but the BatchControlPanel component itself (line 441) also uses `flex-1 flex flex-col min-h-0`. The nested flex-1 containers with overflow-hidden don't properly constrain the batch panel height relative to the nav bar.

**Fix the center area layout (lines 207-270) as follows:**

1. **Move the navigation controls OUTSIDE and BELOW the conditional content block** — the nav bar should be a sibling of the content area at the same flex level, NOT nested inside a scrollable region.

2. **Restructure the center column** so it uses this pattern:
   ```
   <div className="flex-1 flex flex-col p-6 min-h-0">
     {/* Content area: takes remaining space, clips overflow */}
     <div className="flex-1 min-h-0 overflow-hidden">
       {isBatch ? <BatchControlPanel .../> : <SlidePreview .../>}
     </div>
     {/* Nav bar: fixed height, never obscured */}
     <div className="shrink-0 flex items-center justify-between pt-4 border-t border-gray-200">
       ...Previous / counter / Next...
     </div>
   </div>
   ```

3. **Remove the wrapping div around BatchControlPanel** (the `<div className="flex-1 min-h-0 mb-4 overflow-hidden">` at line 209). Instead, let the BatchControlPanel render directly as the content of the overflow-hidden content area. The BatchControlPanel already has `flex-1 flex flex-col min-h-0` which will work correctly when it's the direct child of the content area.

4. **On the slide preview branch** (lines 223-247), remove the `mb-6` margin bottom since the content area's `overflow-hidden` will constrain it, and the `pt-4` on the nav bar provides the gap.

5. **Ensure the BatchControlPanel's internal scrollable region** (the `<div className="flex-1 overflow-y-auto border rounded-lg ...">` at line 460) properly scrolls within the constrained height. This already has the right classes — it just needs the parent layout to actually constrain it.

**Key principle:** The flex column must be: `[flex-1 overflow-hidden content] + [shrink-0 nav bar]`. The `overflow-hidden` on the content area is what prevents the batch panel from growing past the nav bar. The nav bar's `shrink-0` ensures it keeps its natural height.

Do NOT change the BatchControlPanel component internals, the ProjectionPreview component, the left sidebar, or the right sidebar. Only restructure the center column layout.
  </action>
  <verify>
Run `npx tsc --noEmit` — no TypeScript errors.
Run `npm run build` — production build succeeds.
Visually inspect the component structure: the nav bar div with Previous/Next buttons must be a direct sibling of the content area div, both inside the center column flex container, with the content area using `overflow-hidden` and the nav bar using `shrink-0`.
  </verify>
  <done>
Navigation Previous/Next buttons are structurally guaranteed to be visible below the batch control panel at all viewport heights. The batch panel's scrollable content is bounded by the overflow-hidden content area and cannot visually overlap the nav bar.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify nav buttons visible during batch and slide views</name>
  <what-built>Restructured center area layout in PresentationControls to guarantee navigation buttons are always visible, regardless of batch panel content height.</what-built>
  <how-to-verify>
    1. Open the app and navigate to a session with slides and at least one batch with multiple questions
    2. Enter presentation mode (click "Present" or equivalent)
    3. Navigate to a SLIDE item — confirm Previous/Next buttons are fully visible at the bottom of the center area
    4. Navigate to a BATCH item — confirm Previous/Next buttons are fully visible at the bottom, not obscured by the batch control panel
    5. In batch view, scroll through question content (chart + reasons) — confirm the batch content scrolls within its area and does NOT overlap the nav buttons
    6. Try resizing the browser window smaller — confirm nav buttons remain visible even with reduced height
    7. Switch between batch questions using the Q1/Q2/etc tabs — confirm nav buttons stay visible throughout
  </how-to-verify>
  <resume-signal>Type "approved" if nav buttons are always visible, or describe any remaining layout issues</resume-signal>
</task>

</tasks>

<verification>
- PRES-06 satisfied: Navigation buttons fully visible and not obscured by batch controls
- No regression on slide view: Previous/Next still visible during slide navigation
- No regression on batch functionality: Question tabs, reveal, reason highlight all still functional
- TypeScript builds clean
- Production build succeeds
</verification>

<success_criteria>
Navigation Previous and Next buttons are always fully visible and clickable in both slide view and batch view, at any reasonable viewport height. The batch control panel content scrolls within its own bounded area and never visually overlaps or obscures the navigation bar.
</success_criteria>

<output>
After completion, create `.planning/phases/24-presentation-polish/24-05-SUMMARY.md`
</output>
